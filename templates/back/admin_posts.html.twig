{% extends 'base.html.twig' %}

{% block title %}AMAP Pré-vert - Gestion des articles{% endblock %}

{% block stylesheets %}
	<link rel="stylesheet" href="{{ asset('css/posts.css') }}">
	<link rel="stylesheet" href="{{ asset('css/admin_contracts.css') }}">
{% endblock %}

{% block nav %}
	{% include 'back/admin_nav.html.twig' %}
{% endblock %}

{% block body %}
	<div class="container">
		<header>
			<div class="row text-center">
				<div class="col-lg-12">
					<h2>Gestion des articles</h2>
				</div>
			</div>
		</header>

		<section class="mt-4 mb-4" id="filters">
			<div class="row justify-content-center align-items-center text-center">
				<div class="col-lg-2">
					<p>Label année</p>
				</div>
				<div class="col-lg-2">
					<p>Champ année</p>
				</div>
				<div class="col-lg-2">
					<p>Label tag</p>
				</div>
				<div class="col-lg-2">
					<p>Champ tag</p>
				</div>
				<div class="col-lg-2">
					<button class="btn btn-primary">Filtrer</button>
				</div>
			</div>
		</section>

		<section class="mt-4 mb-4" id="postsCrud">
			<table class="table">
				<thead class="thead-dark">
					<tr>
						<th>Titre</th>
						<th>Catégorie</th>
						<th>Date de publication</th>
						<th>Date de modification</th>
						<th>Gestion de l'article</th>
					</tr>
				</thead>
				<tbody>
					{% for post in posts %}
						<tr>
							<td>{{ post.title }}</td>
							<td>{{ post.category.name }}</td>
							<td>{{ post.createdAt|date("d/m/Y") }}</td>
							<td>{% if post.updatedAt is not empty %} {{ post.updatedAt|date("d/m/Y") }} {% else %} - {% endif %}</td>
							<td>
								<a href="{{ path('post.show', {id: post.id}) }}" class="btn btn-success">Visualiser</a>
								<a href="{{ path('admin.post.update', {id: post.id}) }}" class="btn btn-warning">Modifier</a>
								<form method="POST" action="{{ path('admin.post.delete', {id: post.id}) }}" onsubmit="return confirm('Souhaitez-vous vraiment supprimer cette article?')">
									<input type="hidden" name="_method" value="delete">
									<input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
									<button class="btn btn-danger">Supprimer</button>
								</form>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
			<div class="row justify-content-center" id="pagination">
				{{ knp_pagination_render(posts) }}
			</div>
			<div class="text-left">
				<a href="{{ path('admin.post.create') }}" class="btn btn-primary">Ajouter un nouvel article</a>
			</div>
		</section>
	</div>
{% endblock %}

{% block javascripts %}
{% endblock %}